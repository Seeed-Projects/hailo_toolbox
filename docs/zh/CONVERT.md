# Hailo æ¨¡å‹è½¬æ¢æŒ‡å—

æœ¬æ–‡æ¡£å°†æ‰‹æŠŠæ‰‹æ•™æ‚¨å¦‚ä½•å°†å¸¸è§çš„æ·±åº¦å­¦ä¹ æ¨¡å‹è½¬æ¢ä¸º Hailo ç¡¬ä»¶å¯ä»¥è¿è¡Œçš„ `.hef` æ ¼å¼ã€‚å³ä½¿æ‚¨æ˜¯åˆå­¦è€…ï¼Œä¹Ÿèƒ½è½»æ¾å®Œæˆæ¨¡å‹è½¬æ¢ã€‚

## ä»€ä¹ˆæ˜¯æ¨¡å‹è½¬æ¢ï¼Ÿ

ç®€å•æ¥è¯´ï¼Œæ¨¡å‹è½¬æ¢å°±æ˜¯æŠŠæ‚¨è®­ç»ƒå¥½çš„æ¨¡å‹"ç¿»è¯‘"æˆ Hailo AI èŠ¯ç‰‡èƒ½å¤Ÿç†è§£çš„è¯­è¨€ã€‚å°±åƒæŠŠä¸­æ–‡ç¿»è¯‘æˆè‹±æ–‡ä¸€æ ·ã€‚

### ä¸ºä»€ä¹ˆéœ€è¦è½¬æ¢ï¼Ÿ

- **å…¼å®¹æ€§**: ä¸åŒçš„ AI èŠ¯ç‰‡æœ‰ä¸åŒçš„"è¯­è¨€"ï¼Œéœ€è¦è½¬æ¢æ‰èƒ½è¿è¡Œ
- **ä¼˜åŒ–**: è½¬æ¢è¿‡ç¨‹ä¼šé’ˆå¯¹ Hailo èŠ¯ç‰‡è¿›è¡Œä¼˜åŒ–ï¼Œæå‡è¿è¡Œé€Ÿåº¦
- **å‹ç¼©**: è½¬æ¢åçš„æ¨¡å‹é€šå¸¸æ›´å°ï¼Œå ç”¨æ›´å°‘å­˜å‚¨ç©ºé—´

## æ”¯æŒçš„æ¨¡å‹æ ¼å¼

### è¾“å…¥æ ¼å¼ï¼ˆæ‚¨çš„æ¨¡å‹ï¼‰

| æ¡†æ¶ | æ–‡ä»¶æ ¼å¼ | å¸¸è§ç”¨é€” | ç¤ºä¾‹æ–‡ä»¶å |
|------|----------|----------|------------|
| **ONNX** | `.onnx` | é€šç”¨æ ¼å¼ï¼Œæ¨è | `yolov8n.onnx` |
| **TensorFlow** | `.h5` | Keras æ¨¡å‹ | `model.h5` |
| **TensorFlow** | `saved_model.pb` | TensorFlow ä¿å­˜çš„æ¨¡å‹ | `saved_model.pb` |
| **TensorFlow Lite** | `.tflite` | ç§»åŠ¨ç«¯æ¨¡å‹ | `model.tflite` |
| **PyTorch** | `.pt` | TorchScript æ¨¡å‹ | `model.pt` |
| **PaddlePaddle** | æ¨ç†æ¨¡å‹ | ç™¾åº¦é£æ¡¨æ¨¡å‹ | `inference.pdmodel` |

### è¾“å‡ºæ ¼å¼ï¼ˆè½¬æ¢åï¼‰

- **`.hef`**: Hailo Executable Formatï¼ŒHailo ä¸“ç”¨çš„ä¼˜åŒ–æ ¼å¼

## å‡†å¤‡å·¥ä½œ

### 1. ç¡®è®¤ç³»ç»Ÿè¦æ±‚

```bash
# æ£€æŸ¥æ“ä½œç³»ç»Ÿï¼ˆå¿…é¡»æ˜¯ Linuxï¼‰
uname -a

# æ£€æŸ¥ Python ç‰ˆæœ¬ï¼ˆéœ€è¦ 3.8-3.11ï¼‰
python3 --version
```

### 2. å®‰è£…å¿…è¦è½¯ä»¶

```bash
# å®‰è£… Hailo Toolbox
pip install -e .

# éªŒè¯å®‰è£…
hailo-toolbox --version
```

### 3. å‡†å¤‡æ¨¡å‹æ–‡ä»¶

ç¡®ä¿æ‚¨æœ‰ï¼š
- âœ… æ¨¡å‹æ–‡ä»¶ï¼ˆå¦‚ `model.onnx`ï¼‰
- âœ… çŸ¥é“æ¨¡å‹çš„è¾“å…¥å°ºå¯¸ï¼ˆå¦‚ 640x640ï¼‰
- âœ… æ ¡å‡†æ•°æ®é›†ï¼ˆæ¨èï¼Œå¯é€‰ï¼‰

## åŸºç¡€è½¬æ¢æ•™ç¨‹

### ç¬¬ä¸€æ­¥ï¼šæœ€ç®€å•çš„è½¬æ¢

å¦‚æœæ‚¨æœ‰ä¸€ä¸ª ONNX æ¨¡å‹ï¼Œæœ€ç®€å•çš„è½¬æ¢å‘½ä»¤æ˜¯ï¼š

```bash
hailo-toolbox convert your_model.onnx
```

**è§£é‡Š**:
- `hailo-toolbox convert`: å¯åŠ¨è½¬æ¢å·¥å…·
- `your_model.onnx`: æ‚¨çš„æ¨¡å‹æ–‡ä»¶å

è½¬æ¢å®Œæˆåï¼Œä¼šåœ¨åŒä¸€ç›®å½•ç”Ÿæˆ `your_model.hef` æ–‡ä»¶ã€‚

### ç¬¬äºŒæ­¥ï¼šæŒ‡å®šè¾“å‡ºç›®å½•

ä¸ºäº†æ›´å¥½åœ°ç®¡ç†æ–‡ä»¶ï¼Œå»ºè®®æŒ‡å®šè¾“å‡ºç›®å½•ï¼š

```bash
hailo-toolbox convert your_model.onnx --output-dir ./converted_models
```

è¿™æ ·è½¬æ¢åçš„æ–‡ä»¶ä¼šä¿å­˜åœ¨ `converted_models` æ–‡ä»¶å¤¹ä¸­ã€‚

### ç¬¬ä¸‰æ­¥ï¼šæŒ‡å®šç¡¬ä»¶æ¶æ„

æ ¹æ®æ‚¨çš„ Hailo è®¾å¤‡é€‰æ‹©å¯¹åº”çš„æ¶æ„ï¼š

```bash
# Hailo-8 èŠ¯ç‰‡ï¼ˆæœ€å¸¸è§ï¼‰
hailo-toolbox convert your_model.onnx --hw-arch hailo8

# Hailo-8L èŠ¯ç‰‡
hailo-toolbox convert your_model.onnx --hw-arch hailo8l

# Hailo-15 èŠ¯ç‰‡
hailo-toolbox convert your_model.onnx --hw-arch hailo15

# Hailo-15L èŠ¯ç‰‡
hailo-toolbox convert your_model.onnx --hw-arch hailo15l
```

## é«˜çº§è½¬æ¢é€‰é¡¹

### ä½¿ç”¨æ ¡å‡†æ•°æ®é›†ï¼ˆæ¨èï¼‰

æ ¡å‡†æ•°æ®é›†å¯ä»¥æé«˜è½¬æ¢åæ¨¡å‹çš„ç²¾åº¦ï¼š

```bash
hailo-toolbox convert your_model.onnx \
    --hw-arch hailo8 \
    --calib-set-path ./calibration_images \
    --output-dir ./converted_models
```

**æ ¡å‡†æ•°æ®é›†è¦æ±‚**:
- ğŸ“ åŒ…å«ä»£è¡¨æ€§å›¾åƒçš„æ–‡ä»¶å¤¹
- ğŸ–¼ï¸ å›¾åƒæ ¼å¼ï¼šJPGã€PNG ç­‰
- ğŸ“Š æ•°é‡ï¼šå»ºè®® 100-1000 å¼ 
- ğŸ¯ å†…å®¹ï¼šä¸å®é™…ä½¿ç”¨åœºæ™¯ç›¸ä¼¼çš„å›¾åƒ

### æŒ‡å®šè¾“å…¥å°ºå¯¸

å¦‚æœè½¬æ¢æ—¶å‡ºç°å°ºå¯¸ç›¸å…³é”™è¯¯ï¼Œå¯ä»¥æ‰‹åŠ¨æŒ‡å®šï¼š

```bash
hailo-toolbox convert your_model.onnx \
    --input-shape 640,640,3 \
    --hw-arch hailo8
```

**è¾“å…¥å°ºå¯¸æ ¼å¼**:
- `640,640,3`: å®½åº¦,é«˜åº¦,é€šé“æ•°
- `224,224,3`: å¸¸è§çš„åˆ†ç±»æ¨¡å‹å°ºå¯¸
- `320,320,3`: è½»é‡çº§æ£€æµ‹æ¨¡å‹å°ºå¯¸

### ä½¿ç”¨éšæœºæ ¡å‡†ï¼ˆå¿«é€Ÿæµ‹è¯•ï¼‰

å¦‚æœæ²¡æœ‰æ ¡å‡†æ•°æ®é›†ï¼Œå¯ä»¥ä½¿ç”¨éšæœºæ•°æ®ï¼š

```bash
hailo-toolbox convert your_model.onnx \
    --use-random-calib-set \
    --hw-arch hailo8
```

âš ï¸ **æ³¨æ„**: éšæœºæ ¡å‡†çš„ç²¾åº¦å¯èƒ½è¾ƒä½ï¼Œä»…é€‚åˆå¿«é€Ÿæµ‹è¯•ã€‚

## å®é™…è½¬æ¢ç¤ºä¾‹

### ç¤ºä¾‹ 1: YOLOv8 ç›®æ ‡æ£€æµ‹æ¨¡å‹

```bash
# ä¸‹è½½ YOLOv8 ONNX æ¨¡å‹ï¼ˆå‡è®¾æ‚¨å·²æœ‰ï¼‰
# è½¬æ¢å‘½ä»¤
hailo-toolbox convert yolov8n.onnx \
    --hw-arch hailo8 \
    --input-shape 640,640,3 \
    --calib-set-path ./coco_samples \
    --output-dir ./converted_models \
    --save-onnx
```

**å‚æ•°è¯´æ˜**:
- `--input-shape 640,640,3`: YOLOv8 çš„æ ‡å‡†è¾“å…¥å°ºå¯¸
- `--calib-set-path ./coco_samples`: ä½¿ç”¨ COCO æ•°æ®é›†æ ·æœ¬æ ¡å‡†
- `--save-onnx`: ä¿å­˜ä¼˜åŒ–åçš„ ONNX æ–‡ä»¶

### ç¤ºä¾‹ 2: å›¾åƒåˆ†ç±»æ¨¡å‹

```bash
hailo-toolbox convert efficientnet.onnx \
    --hw-arch hailo8 \
    --input-shape 224,224,3 \
    --calib-set-path ./imagenet_samples \
    --output-dir ./converted_models
```

### ç¤ºä¾‹ 3: å¿«é€Ÿæµ‹è¯•è½¬æ¢

```bash
# æœ€å¿«çš„è½¬æ¢æ–¹å¼ï¼ˆç”¨äºå¿«é€ŸéªŒè¯ï¼‰
hailo-toolbox convert test_model.onnx \
    --use-random-calib-set \
    --hw-arch hailo8
```

## è½¬æ¢å‚æ•°è¯¦è§£

### å¿…éœ€å‚æ•°

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `model` | è¾“å…¥æ¨¡å‹æ–‡ä»¶è·¯å¾„ | `yolov8n.onnx` |

### å¸¸ç”¨å¯é€‰å‚æ•°

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ | ç¤ºä¾‹ |
|------|--------|------|------|
| `--hw-arch` | `hailo8` | ç¡¬ä»¶æ¶æ„ | `hailo8`, `hailo15` |
| `--output-dir` | æ¨¡å‹åŒç›®å½• | è¾“å‡ºç›®å½• | `./models` |
| `--input-shape` | è‡ªåŠ¨æ£€æµ‹ | è¾“å…¥å°ºå¯¸ | `640,640,3` |
| `--calib-set-path` | æ—  | æ ¡å‡†æ•°æ®é›†è·¯å¾„ | `./calib_images` |
| `--use-random-calib-set` | `False` | ä½¿ç”¨éšæœºæ ¡å‡† | - |
| `--save-onnx` | `False` | ä¿å­˜ä¼˜åŒ–çš„ONNX | - |
| `--profile` | `False` | ç”Ÿæˆæ€§èƒ½æŠ¥å‘Š | - |

## å¸¸è§é—®é¢˜è§£å†³

### Q1: è½¬æ¢æ—¶æç¤º"æ‰¾ä¸åˆ°æ¨¡å‹æ–‡ä»¶"

**é—®é¢˜**: `FileNotFoundError: model.onnx not found`

**è§£å†³æ–¹æ³•**:
```bash
# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la your_model.onnx

# ä½¿ç”¨ç»å¯¹è·¯å¾„
hailo-toolbox convert /full/path/to/your_model.onnx
```

### Q2: è½¬æ¢æ—¶æç¤ºéœ€è¦æ ¡å‡†æ•°æ®é›†

**é—®é¢˜**: `calibration dataset required`

**è§£å†³æ–¹æ³•**:
```bash
# æ–¹æ³•1: ä½¿ç”¨éšæœºæ ¡å‡†ï¼ˆå¿«é€Ÿï¼‰
hailo-toolbox convert model.onnx --use-random-calib-set

# æ–¹æ³•2: å‡†å¤‡æ ¡å‡†æ•°æ®é›†
mkdir calibration_images
# æ”¾å…¥ä¸€äº›ä»£è¡¨æ€§å›¾åƒ
hailo-toolbox convert model.onnx --calib-set-path ./calibration_images
```

### Q3: è½¬æ¢é€Ÿåº¦å¾ˆæ…¢

**åŸå› **: æ¨¡å‹è½¬æ¢æ˜¯è®¡ç®—å¯†é›†å‹ä»»åŠ¡ï¼Œéœ€è¦æ—¶é—´

**ä¼˜åŒ–å»ºè®®**:
- ä½¿ç”¨è¾ƒå°‘çš„æ ¡å‡†å›¾åƒï¼ˆ100å¼ å·¦å³ï¼‰
- ä½¿ç”¨éšæœºæ ¡å‡†è¿›è¡Œå¿«é€Ÿæµ‹è¯•
- ç¡®ä¿ç³»ç»Ÿæœ‰è¶³å¤Ÿå†…å­˜

### Q4: è½¬æ¢åçš„æ¨¡å‹å¾ˆå¤§

**è§£å†³æ–¹æ³•**:
```bash
# æ£€æŸ¥æ–‡ä»¶å¤§å°
ls -lh *.hef

# å¦‚æœå¤ªå¤§ï¼Œå¯ä»¥å°è¯•ï¼š
# 1. ä½¿ç”¨æ›´å°çš„è¾“å…¥å°ºå¯¸
hailo-toolbox convert model.onnx --input-shape 320,320,3

# 2. æ£€æŸ¥æ˜¯å¦æœ‰ä¸å¿…è¦çš„è¾“å‡ºèŠ‚ç‚¹
hailo-toolbox convert model.onnx --end-nodes output1,output2
```

## éªŒè¯è½¬æ¢ç»“æœ

### æ£€æŸ¥è½¬æ¢æ˜¯å¦æˆåŠŸ

```bash
# æ£€æŸ¥ç”Ÿæˆçš„æ–‡ä»¶
ls -la *.hef

# æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯
file your_model.hef
```

### å¿«é€Ÿæµ‹è¯•è½¬æ¢åçš„æ¨¡å‹

```bash
# ä½¿ç”¨è½¬æ¢åçš„æ¨¡å‹è¿›è¡Œæ¨ç†æµ‹è¯•
hailo-toolbox infer your_model.hef \
    --source test_image.jpg \
    --task-name yolov8det \
    --show
```

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. æ ¡å‡†æ•°æ®é›†ä¼˜åŒ–

- **æ•°é‡**: 100-500å¼ å›¾åƒé€šå¸¸è¶³å¤Ÿ
- **è´¨é‡**: é€‰æ‹©ä¸å®é™…åœºæ™¯ç›¸ä¼¼çš„å›¾åƒ
- **å¤šæ ·æ€§**: åŒ…å«ä¸åŒå…‰ç…§ã€è§’åº¦ã€èƒŒæ™¯çš„å›¾åƒ

### 2. è¾“å…¥å°ºå¯¸é€‰æ‹©

```bash
# é«˜ç²¾åº¦ï¼ˆè¾ƒæ…¢ï¼‰
--input-shape 640,640,3

# å¹³è¡¡ï¼ˆæ¨èï¼‰
--input-shape 416,416,3

# é«˜é€Ÿåº¦ï¼ˆè¾ƒå¿«ï¼‰
--input-shape 320,320,3
```

### 3. ç¡¬ä»¶æ¶æ„é€‰æ‹©

- **Hailo-8**: é«˜æ€§èƒ½ï¼Œé€‚åˆå¤æ‚æ¨¡å‹
- **Hailo-8L**: ä½åŠŸè€—ç‰ˆæœ¬
- **Hailo-15**: æœ€æ–°æ¶æ„ï¼Œæ›´é«˜æ€§èƒ½

## è½¬æ¢æµç¨‹å›¾

```
[åŸå§‹æ¨¡å‹] â†’ [è½¬æ¢å·¥å…·] â†’ [æ ¡å‡†] â†’ [ä¼˜åŒ–] â†’ [HEFæ¨¡å‹]
    â†“            â†“          â†“        â†“         â†“
 .onnxæ–‡ä»¶   hailo-toolbox  æ ¡å‡†æ•°æ®  ç¡¬ä»¶ä¼˜åŒ–  .hefæ–‡ä»¶
```

## æ€»ç»“

æ¨¡å‹è½¬æ¢çš„åŸºæœ¬æµç¨‹ï¼š

1. **å‡†å¤‡æ¨¡å‹æ–‡ä»¶** (.onnx æ ¼å¼æ¨è)
2. **å‡†å¤‡æ ¡å‡†æ•°æ®** (å¯é€‰ä½†æ¨è)
3. **è¿è¡Œè½¬æ¢å‘½ä»¤** 
4. **éªŒè¯è½¬æ¢ç»“æœ**
5. **æµ‹è¯•æ¨ç†æ€§èƒ½**

**è®°ä½è¿™ä¸ªä¸‡èƒ½å‘½ä»¤**:
```bash
hailo-toolbox convert your_model.onnx \
    --hw-arch hailo8 \
    --calib-set-path ./calibration_images \
    --output-dir ./converted_models
```

è½¬æ¢æˆåŠŸåï¼Œæ‚¨å°±å¯ä»¥åœ¨ Hailo è®¾å¤‡ä¸Šé«˜é€Ÿè¿è¡Œæ‚¨çš„ AI æ¨¡å‹äº†ï¼

---

**ä¸‹ä¸€æ­¥**: å­¦ä¹ å¦‚ä½•ä½¿ç”¨è½¬æ¢åçš„æ¨¡å‹è¿›è¡Œæ¨ç†ï¼Œè¯·å‚è€ƒ [æ¨¡å‹æ¨ç†æŒ‡å—](INFERENCE.md)ã€‚
